# Authors: Sabayon Team
#          geaaru@sabayonlinux.org
pipeline_name: "Repository ARM Base Pipeline"
concurrency: 3





group:

  - staging1
  - staging10
  - staging11
  - staging12
  - staging13
  - staging14
  - staging15
  - staging16
  - staging17
  - staging2
  - staging3
  - staging4
  - staging5
  - staging6
  - staging7
  - staging8
  - staging9

chord:
  - injector
tasks:

  staging1:
    script:
      - source /etc/profile
      # Temporary workaround for delay on DHCP response
      - sleep 4
      - wget https://raw.githubusercontent.com/Sabayon/sabayon-sark/develop/sark-functions.sh -O /sbin/sark-functions.sh
      - chmod 755 /sbin/sark-functions.sh
      - cp -rfv /sbin/sark-functions.sh /etc/sark-functions
      - chmod 755 /etc/sark-functions
      - echo '===> Preparing last step....'
      - wget https://raw.githubusercontent.com/Sabayon/devkit/develop/builder -O /usr/sbin/builder
      - wget https://raw.githubusercontent.com/Sabayon/sabayon-sark/develop/sark-localbuild -O /usr/bin/sark-localbuild
      - wget https://raw.githubusercontent.com/Sabayon/sabayon-sark/develop/sark-localcreaterepo -O /usr/bin/sark-localcreaterepo
      - chmod a+x /usr/sbin/builder
      - chmod a+x /usr/bin/sark-localcreaterepo
      - chmod a+x /usr/bin/sark-localbuild
      - eselect python set python3.6
      # Force py3.6 on eit
      - sed -e 's:python2.7:python:g' -i /usr/bin/eit
      # Create mask file of upstream packages
      - source /sbin/sark-functions.sh
      # Required for update profile confs
      - layman -s sabayon-distro
      - sabayon_mask_upstream_pkgs
      - equo up && equo upgrade
      # Temporary force build
      # - sed -e 's/--update//g' -e 's/--newuse//g' base-build-staging1.yml -i
      - sark-localbuild
      - eval 'rm artifacts/build_*.log || true'
      - mkdir artifacts/staging1
      - mv artifacts/base-arm-binhost/ artifacts/staging1/
    environment:
      - SHELL=/bin/bash
      - SABAYON_ARCH=arm
      - REPOSITORY_NAME=base-arm
      - SAB_BUILDFILE=base-build-staging1.yml
      - ETP_NONINTERACTIVE=1
      # I need call emerge-webrsync at begin to retrive data for active profile.
      # Note: When SKIP_PORTAGE_SYNC is equal to 1 "layman -S" is not executed.
      # - SKIP_PORTAGE_SYNC=1
      - SKIP_CLEAN_PACKAGESDIR=1
      - SAB_PORTDIR=/etc/portage
      - "CREATEREPO_PHASE=false"
      - "ACCEPT_LICENSE=*"
      - "PORTAGE_GIT_URL=https://github.com/Sabayon/gentoo-mirror"
      - "PORTAGE_GIT_BRANCH=arm"
      # Override list of targets for compile specific packages.
      # - OVERRIDE_BUILD_TARGET="app/foo"
    name: "ARM Base (Staging1)"
    artefact_path: artifacts
    
    image: sabayon/builder-arm
    type: lxd
    
    source: https://github.com/Sabayon/sbi-tasks
    directory: "/next/arm/base"
    queue: arm_lxd
    tag_namespace: base-arm-staging1

  staging10:
    script:
      - source /etc/profile
      # Temporary workaround for delay on DHCP response
      - sleep 4
      - wget https://raw.githubusercontent.com/Sabayon/sabayon-sark/develop/sark-functions.sh -O /sbin/sark-functions.sh
      - chmod 755 /sbin/sark-functions.sh
      - cp -rfv /sbin/sark-functions.sh /etc/sark-functions
      - chmod 755 /etc/sark-functions
      - echo '===> Preparing last step....'
      - wget https://raw.githubusercontent.com/Sabayon/devkit/develop/builder -O /usr/sbin/builder
      - wget https://raw.githubusercontent.com/Sabayon/sabayon-sark/develop/sark-localbuild -O /usr/bin/sark-localbuild
      - wget https://raw.githubusercontent.com/Sabayon/sabayon-sark/develop/sark-localcreaterepo -O /usr/bin/sark-localcreaterepo
      - chmod a+x /usr/sbin/builder
      - chmod a+x /usr/bin/sark-localcreaterepo
      - chmod a+x /usr/bin/sark-localbuild
      - eselect python set python3.6
      # Force py3.6 on eit
      - sed -e 's:python2.7:python:g' -i /usr/bin/eit
      # Create mask file of upstream packages
      - source /sbin/sark-functions.sh
      # Required for update profile confs
      - layman -s sabayon-distro
      - sabayon_mask_upstream_pkgs
      - equo up && equo upgrade
      # Temporary force build
      # - sed -e 's/--update//g' -e 's/--newuse//g' base-build-staging10.yml -i
      - sark-localbuild
      - eval 'rm artifacts/build_*.log || true'
      - mkdir artifacts/staging10
      - mv artifacts/base-arm-binhost/ artifacts/staging10/
    environment:
      - SHELL=/bin/bash
      - SABAYON_ARCH=arm
      - REPOSITORY_NAME=base-arm
      - SAB_BUILDFILE=base-build-staging10.yml
      - ETP_NONINTERACTIVE=1
      # I need call emerge-webrsync at begin to retrive data for active profile.
      # Note: When SKIP_PORTAGE_SYNC is equal to 1 "layman -S" is not executed.
      # - SKIP_PORTAGE_SYNC=1
      - SKIP_CLEAN_PACKAGESDIR=1
      - SAB_PORTDIR=/etc/portage
      - "CREATEREPO_PHASE=false"
      - "ACCEPT_LICENSE=*"
      - "PORTAGE_GIT_URL=https://github.com/Sabayon/gentoo-mirror"
      - "PORTAGE_GIT_BRANCH=arm"
      # Override list of targets for compile specific packages.
      # - OVERRIDE_BUILD_TARGET="app/foo"
    name: "ARM Base (Staging10)"
    artefact_path: artifacts
    
    image: sabayon/builder-arm
    type: lxd
    
    source: https://github.com/Sabayon/sbi-tasks
    directory: "/next/arm/base"
    queue: arm_lxd
    tag_namespace: base-arm-staging10

  staging11:
    script:
      - source /etc/profile
      # Temporary workaround for delay on DHCP response
      - sleep 4
      - wget https://raw.githubusercontent.com/Sabayon/sabayon-sark/develop/sark-functions.sh -O /sbin/sark-functions.sh
      - chmod 755 /sbin/sark-functions.sh
      - cp -rfv /sbin/sark-functions.sh /etc/sark-functions
      - chmod 755 /etc/sark-functions
      - echo '===> Preparing last step....'
      - wget https://raw.githubusercontent.com/Sabayon/devkit/develop/builder -O /usr/sbin/builder
      - wget https://raw.githubusercontent.com/Sabayon/sabayon-sark/develop/sark-localbuild -O /usr/bin/sark-localbuild
      - wget https://raw.githubusercontent.com/Sabayon/sabayon-sark/develop/sark-localcreaterepo -O /usr/bin/sark-localcreaterepo
      - chmod a+x /usr/sbin/builder
      - chmod a+x /usr/bin/sark-localcreaterepo
      - chmod a+x /usr/bin/sark-localbuild
      - eselect python set python3.6
      # Force py3.6 on eit
      - sed -e 's:python2.7:python:g' -i /usr/bin/eit
      # Create mask file of upstream packages
      - source /sbin/sark-functions.sh
      # Required for update profile confs
      - layman -s sabayon-distro
      - sabayon_mask_upstream_pkgs
      - equo up && equo upgrade
      # Temporary force build
      # - sed -e 's/--update//g' -e 's/--newuse//g' base-build-staging11.yml -i
      - sark-localbuild
      - eval 'rm artifacts/build_*.log || true'
      - mkdir artifacts/staging11
      - mv artifacts/base-arm-binhost/ artifacts/staging11/
    environment:
      - SHELL=/bin/bash
      - SABAYON_ARCH=arm
      - REPOSITORY_NAME=base-arm
      - SAB_BUILDFILE=base-build-staging11.yml
      - ETP_NONINTERACTIVE=1
      # I need call emerge-webrsync at begin to retrive data for active profile.
      # Note: When SKIP_PORTAGE_SYNC is equal to 1 "layman -S" is not executed.
      # - SKIP_PORTAGE_SYNC=1
      - SKIP_CLEAN_PACKAGESDIR=1
      - SAB_PORTDIR=/etc/portage
      - "CREATEREPO_PHASE=false"
      - "ACCEPT_LICENSE=*"
      - "PORTAGE_GIT_URL=https://github.com/Sabayon/gentoo-mirror"
      - "PORTAGE_GIT_BRANCH=arm"
      # Override list of targets for compile specific packages.
      # - OVERRIDE_BUILD_TARGET="app/foo"
    name: "ARM Base (Staging11)"
    artefact_path: artifacts
    
    image: sabayon/builder-arm
    type: lxd
    
    source: https://github.com/Sabayon/sbi-tasks
    directory: "/next/arm/base"
    queue: arm_lxd
    tag_namespace: base-arm-staging11

  staging12:
    script:
      - source /etc/profile
      # Temporary workaround for delay on DHCP response
      - sleep 4
      - wget https://raw.githubusercontent.com/Sabayon/sabayon-sark/develop/sark-functions.sh -O /sbin/sark-functions.sh
      - chmod 755 /sbin/sark-functions.sh
      - cp -rfv /sbin/sark-functions.sh /etc/sark-functions
      - chmod 755 /etc/sark-functions
      - echo '===> Preparing last step....'
      - wget https://raw.githubusercontent.com/Sabayon/devkit/develop/builder -O /usr/sbin/builder
      - wget https://raw.githubusercontent.com/Sabayon/sabayon-sark/develop/sark-localbuild -O /usr/bin/sark-localbuild
      - wget https://raw.githubusercontent.com/Sabayon/sabayon-sark/develop/sark-localcreaterepo -O /usr/bin/sark-localcreaterepo
      - chmod a+x /usr/sbin/builder
      - chmod a+x /usr/bin/sark-localcreaterepo
      - chmod a+x /usr/bin/sark-localbuild
      - eselect python set python3.6
      # Force py3.6 on eit
      - sed -e 's:python2.7:python:g' -i /usr/bin/eit
      # Create mask file of upstream packages
      - source /sbin/sark-functions.sh
      # Required for update profile confs
      - layman -s sabayon-distro
      - sabayon_mask_upstream_pkgs
      - equo up && equo upgrade
      # Temporary force build
      # - sed -e 's/--update//g' -e 's/--newuse//g' base-build-staging12.yml -i
      - sark-localbuild
      - eval 'rm artifacts/build_*.log || true'
      - mkdir artifacts/staging12
      - mv artifacts/base-arm-binhost/ artifacts/staging12/
    environment:
      - SHELL=/bin/bash
      - SABAYON_ARCH=arm
      - REPOSITORY_NAME=base-arm
      - SAB_BUILDFILE=base-build-staging12.yml
      - ETP_NONINTERACTIVE=1
      # I need call emerge-webrsync at begin to retrive data for active profile.
      # Note: When SKIP_PORTAGE_SYNC is equal to 1 "layman -S" is not executed.
      # - SKIP_PORTAGE_SYNC=1
      - SKIP_CLEAN_PACKAGESDIR=1
      - SAB_PORTDIR=/etc/portage
      - "CREATEREPO_PHASE=false"
      - "ACCEPT_LICENSE=*"
      - "PORTAGE_GIT_URL=https://github.com/Sabayon/gentoo-mirror"
      - "PORTAGE_GIT_BRANCH=arm"
      # Override list of targets for compile specific packages.
      # - OVERRIDE_BUILD_TARGET="app/foo"
    name: "ARM Base (Staging12)"
    artefact_path: artifacts
    
    image: sabayon/builder-arm
    type: lxd
    
    source: https://github.com/Sabayon/sbi-tasks
    directory: "/next/arm/base"
    queue: arm_lxd
    tag_namespace: base-arm-staging12

  staging13:
    script:
      - source /etc/profile
      # Temporary workaround for delay on DHCP response
      - sleep 4
      - wget https://raw.githubusercontent.com/Sabayon/sabayon-sark/develop/sark-functions.sh -O /sbin/sark-functions.sh
      - chmod 755 /sbin/sark-functions.sh
      - cp -rfv /sbin/sark-functions.sh /etc/sark-functions
      - chmod 755 /etc/sark-functions
      - echo '===> Preparing last step....'
      - wget https://raw.githubusercontent.com/Sabayon/devkit/develop/builder -O /usr/sbin/builder
      - wget https://raw.githubusercontent.com/Sabayon/sabayon-sark/develop/sark-localbuild -O /usr/bin/sark-localbuild
      - wget https://raw.githubusercontent.com/Sabayon/sabayon-sark/develop/sark-localcreaterepo -O /usr/bin/sark-localcreaterepo
      - chmod a+x /usr/sbin/builder
      - chmod a+x /usr/bin/sark-localcreaterepo
      - chmod a+x /usr/bin/sark-localbuild
      - eselect python set python3.6
      # Force py3.6 on eit
      - sed -e 's:python2.7:python:g' -i /usr/bin/eit
      # Create mask file of upstream packages
      - source /sbin/sark-functions.sh
      # Required for update profile confs
      - layman -s sabayon-distro
      - sabayon_mask_upstream_pkgs
      - equo up && equo upgrade
      # Temporary force build
      # - sed -e 's/--update//g' -e 's/--newuse//g' base-build-staging13.yml -i
      - sark-localbuild
      - eval 'rm artifacts/build_*.log || true'
      - mkdir artifacts/staging13
      - mv artifacts/base-arm-binhost/ artifacts/staging13/
    environment:
      - SHELL=/bin/bash
      - SABAYON_ARCH=arm
      - REPOSITORY_NAME=base-arm
      - SAB_BUILDFILE=base-build-staging13.yml
      - ETP_NONINTERACTIVE=1
      # I need call emerge-webrsync at begin to retrive data for active profile.
      # Note: When SKIP_PORTAGE_SYNC is equal to 1 "layman -S" is not executed.
      # - SKIP_PORTAGE_SYNC=1
      - SKIP_CLEAN_PACKAGESDIR=1
      - SAB_PORTDIR=/etc/portage
      - "CREATEREPO_PHASE=false"
      - "ACCEPT_LICENSE=*"
      - "PORTAGE_GIT_URL=https://github.com/Sabayon/gentoo-mirror"
      - "PORTAGE_GIT_BRANCH=arm"
      # Override list of targets for compile specific packages.
      # - OVERRIDE_BUILD_TARGET="app/foo"
    name: "ARM Base (Staging13)"
    artefact_path: artifacts
    
    image: sabayon/builder-arm
    type: lxd
    
    source: https://github.com/Sabayon/sbi-tasks
    directory: "/next/arm/base"
    queue: arm_lxd
    tag_namespace: base-arm-staging13

  staging14:
    script:
      - source /etc/profile
      # Temporary workaround for delay on DHCP response
      - sleep 4
      - wget https://raw.githubusercontent.com/Sabayon/sabayon-sark/develop/sark-functions.sh -O /sbin/sark-functions.sh
      - chmod 755 /sbin/sark-functions.sh
      - cp -rfv /sbin/sark-functions.sh /etc/sark-functions
      - chmod 755 /etc/sark-functions
      - echo '===> Preparing last step....'
      - wget https://raw.githubusercontent.com/Sabayon/devkit/develop/builder -O /usr/sbin/builder
      - wget https://raw.githubusercontent.com/Sabayon/sabayon-sark/develop/sark-localbuild -O /usr/bin/sark-localbuild
      - wget https://raw.githubusercontent.com/Sabayon/sabayon-sark/develop/sark-localcreaterepo -O /usr/bin/sark-localcreaterepo
      - chmod a+x /usr/sbin/builder
      - chmod a+x /usr/bin/sark-localcreaterepo
      - chmod a+x /usr/bin/sark-localbuild
      - eselect python set python3.6
      # Force py3.6 on eit
      - sed -e 's:python2.7:python:g' -i /usr/bin/eit
      # Create mask file of upstream packages
      - source /sbin/sark-functions.sh
      # Required for update profile confs
      - layman -s sabayon-distro
      - sabayon_mask_upstream_pkgs
      - equo up && equo upgrade
      # Temporary force build
      # - sed -e 's/--update//g' -e 's/--newuse//g' base-build-staging14.yml -i
      - sark-localbuild
      - eval 'rm artifacts/build_*.log || true'
      - mkdir artifacts/staging14
      - mv artifacts/base-arm-binhost/ artifacts/staging14/
    environment:
      - SHELL=/bin/bash
      - SABAYON_ARCH=arm
      - REPOSITORY_NAME=base-arm
      - SAB_BUILDFILE=base-build-staging14.yml
      - ETP_NONINTERACTIVE=1
      # I need call emerge-webrsync at begin to retrive data for active profile.
      # Note: When SKIP_PORTAGE_SYNC is equal to 1 "layman -S" is not executed.
      # - SKIP_PORTAGE_SYNC=1
      - SKIP_CLEAN_PACKAGESDIR=1
      - SAB_PORTDIR=/etc/portage
      - "CREATEREPO_PHASE=false"
      - "ACCEPT_LICENSE=*"
      - "PORTAGE_GIT_URL=https://github.com/Sabayon/gentoo-mirror"
      - "PORTAGE_GIT_BRANCH=arm"
      # Override list of targets for compile specific packages.
      # - OVERRIDE_BUILD_TARGET="app/foo"
    name: "ARM Base (Staging14)"
    artefact_path: artifacts
    
    image: sabayon/builder-arm
    type: lxd
    
    source: https://github.com/Sabayon/sbi-tasks
    directory: "/next/arm/base"
    queue: arm_lxd
    tag_namespace: base-arm-staging14

  staging15:
    script:
      - source /etc/profile
      # Temporary workaround for delay on DHCP response
      - sleep 4
      - wget https://raw.githubusercontent.com/Sabayon/sabayon-sark/develop/sark-functions.sh -O /sbin/sark-functions.sh
      - chmod 755 /sbin/sark-functions.sh
      - cp -rfv /sbin/sark-functions.sh /etc/sark-functions
      - chmod 755 /etc/sark-functions
      - echo '===> Preparing last step....'
      - wget https://raw.githubusercontent.com/Sabayon/devkit/develop/builder -O /usr/sbin/builder
      - wget https://raw.githubusercontent.com/Sabayon/sabayon-sark/develop/sark-localbuild -O /usr/bin/sark-localbuild
      - wget https://raw.githubusercontent.com/Sabayon/sabayon-sark/develop/sark-localcreaterepo -O /usr/bin/sark-localcreaterepo
      - chmod a+x /usr/sbin/builder
      - chmod a+x /usr/bin/sark-localcreaterepo
      - chmod a+x /usr/bin/sark-localbuild
      - eselect python set python3.6
      # Force py3.6 on eit
      - sed -e 's:python2.7:python:g' -i /usr/bin/eit
      # Create mask file of upstream packages
      - source /sbin/sark-functions.sh
      # Required for update profile confs
      - layman -s sabayon-distro
      - sabayon_mask_upstream_pkgs
      - equo up && equo upgrade
      # Temporary force build
      # - sed -e 's/--update//g' -e 's/--newuse//g' base-build-staging15.yml -i
      - sark-localbuild
      - eval 'rm artifacts/build_*.log || true'
      - mkdir artifacts/staging15
      - mv artifacts/base-arm-binhost/ artifacts/staging15/
    environment:
      - SHELL=/bin/bash
      - SABAYON_ARCH=arm
      - REPOSITORY_NAME=base-arm
      - SAB_BUILDFILE=base-build-staging15.yml
      - ETP_NONINTERACTIVE=1
      # I need call emerge-webrsync at begin to retrive data for active profile.
      # Note: When SKIP_PORTAGE_SYNC is equal to 1 "layman -S" is not executed.
      # - SKIP_PORTAGE_SYNC=1
      - SKIP_CLEAN_PACKAGESDIR=1
      - SAB_PORTDIR=/etc/portage
      - "CREATEREPO_PHASE=false"
      - "ACCEPT_LICENSE=*"
      - "PORTAGE_GIT_URL=https://github.com/Sabayon/gentoo-mirror"
      - "PORTAGE_GIT_BRANCH=arm"
      # Override list of targets for compile specific packages.
      # - OVERRIDE_BUILD_TARGET="app/foo"
    name: "ARM Base (Staging15)"
    artefact_path: artifacts
    
    image: sabayon/builder-arm
    type: lxd
    
    source: https://github.com/Sabayon/sbi-tasks
    directory: "/next/arm/base"
    queue: arm_lxd
    tag_namespace: base-arm-staging15

  staging16:
    script:
      - source /etc/profile
      # Temporary workaround for delay on DHCP response
      - sleep 4
      - wget https://raw.githubusercontent.com/Sabayon/sabayon-sark/develop/sark-functions.sh -O /sbin/sark-functions.sh
      - chmod 755 /sbin/sark-functions.sh
      - cp -rfv /sbin/sark-functions.sh /etc/sark-functions
      - chmod 755 /etc/sark-functions
      - echo '===> Preparing last step....'
      - wget https://raw.githubusercontent.com/Sabayon/devkit/develop/builder -O /usr/sbin/builder
      - wget https://raw.githubusercontent.com/Sabayon/sabayon-sark/develop/sark-localbuild -O /usr/bin/sark-localbuild
      - wget https://raw.githubusercontent.com/Sabayon/sabayon-sark/develop/sark-localcreaterepo -O /usr/bin/sark-localcreaterepo
      - chmod a+x /usr/sbin/builder
      - chmod a+x /usr/bin/sark-localcreaterepo
      - chmod a+x /usr/bin/sark-localbuild
      - eselect python set python3.6
      # Force py3.6 on eit
      - sed -e 's:python2.7:python:g' -i /usr/bin/eit
      # Create mask file of upstream packages
      - source /sbin/sark-functions.sh
      # Required for update profile confs
      - layman -s sabayon-distro
      - sabayon_mask_upstream_pkgs
      - equo up && equo upgrade
      # Temporary force build
      # - sed -e 's/--update//g' -e 's/--newuse//g' base-build-staging16.yml -i
      - sark-localbuild
      - eval 'rm artifacts/build_*.log || true'
      - mkdir artifacts/staging16
      - mv artifacts/base-arm-binhost/ artifacts/staging16/
    environment:
      - SHELL=/bin/bash
      - SABAYON_ARCH=arm
      - REPOSITORY_NAME=base-arm
      - SAB_BUILDFILE=base-build-staging16.yml
      - ETP_NONINTERACTIVE=1
      # I need call emerge-webrsync at begin to retrive data for active profile.
      # Note: When SKIP_PORTAGE_SYNC is equal to 1 "layman -S" is not executed.
      # - SKIP_PORTAGE_SYNC=1
      - SKIP_CLEAN_PACKAGESDIR=1
      - SAB_PORTDIR=/etc/portage
      - "CREATEREPO_PHASE=false"
      - "ACCEPT_LICENSE=*"
      - "PORTAGE_GIT_URL=https://github.com/Sabayon/gentoo-mirror"
      - "PORTAGE_GIT_BRANCH=arm"
      # Override list of targets for compile specific packages.
      # - OVERRIDE_BUILD_TARGET="app/foo"
    name: "ARM Base (Staging16)"
    artefact_path: artifacts
    
    image: sabayon/builder-arm
    type: lxd
    
    source: https://github.com/Sabayon/sbi-tasks
    directory: "/next/arm/base"
    queue: arm_lxd
    tag_namespace: base-arm-staging16

  staging17:
    script:
      - source /etc/profile
      # Temporary workaround for delay on DHCP response
      - sleep 4
      - wget https://raw.githubusercontent.com/Sabayon/sabayon-sark/develop/sark-functions.sh -O /sbin/sark-functions.sh
      - chmod 755 /sbin/sark-functions.sh
      - cp -rfv /sbin/sark-functions.sh /etc/sark-functions
      - chmod 755 /etc/sark-functions
      - echo '===> Preparing last step....'
      - wget https://raw.githubusercontent.com/Sabayon/devkit/develop/builder -O /usr/sbin/builder
      - wget https://raw.githubusercontent.com/Sabayon/sabayon-sark/develop/sark-localbuild -O /usr/bin/sark-localbuild
      - wget https://raw.githubusercontent.com/Sabayon/sabayon-sark/develop/sark-localcreaterepo -O /usr/bin/sark-localcreaterepo
      - chmod a+x /usr/sbin/builder
      - chmod a+x /usr/bin/sark-localcreaterepo
      - chmod a+x /usr/bin/sark-localbuild
      - eselect python set python3.6
      # Force py3.6 on eit
      - sed -e 's:python2.7:python:g' -i /usr/bin/eit
      # Create mask file of upstream packages
      - source /sbin/sark-functions.sh
      # Required for update profile confs
      - layman -s sabayon-distro
      - sabayon_mask_upstream_pkgs
      - equo up && equo upgrade
      # Temporary force build
      # - sed -e 's/--update//g' -e 's/--newuse//g' base-build-staging17.yml -i
      - sark-localbuild
      - eval 'rm artifacts/build_*.log || true'
      - mkdir artifacts/staging17
      - mv artifacts/base-arm-binhost/ artifacts/staging17/
    environment:
      - SHELL=/bin/bash
      - SABAYON_ARCH=arm
      - REPOSITORY_NAME=base-arm
      - SAB_BUILDFILE=base-build-staging17.yml
      - ETP_NONINTERACTIVE=1
      # I need call emerge-webrsync at begin to retrive data for active profile.
      # Note: When SKIP_PORTAGE_SYNC is equal to 1 "layman -S" is not executed.
      # - SKIP_PORTAGE_SYNC=1
      - SKIP_CLEAN_PACKAGESDIR=1
      - SAB_PORTDIR=/etc/portage
      - "CREATEREPO_PHASE=false"
      - "ACCEPT_LICENSE=*"
      - "PORTAGE_GIT_URL=https://github.com/Sabayon/gentoo-mirror"
      - "PORTAGE_GIT_BRANCH=arm"
      # Override list of targets for compile specific packages.
      # - OVERRIDE_BUILD_TARGET="app/foo"
    name: "ARM Base (Staging17)"
    artefact_path: artifacts
    
    image: sabayon/builder-arm
    type: lxd
    
    source: https://github.com/Sabayon/sbi-tasks
    directory: "/next/arm/base"
    queue: arm_lxd
    tag_namespace: base-arm-staging17

  staging2:
    script:
      - source /etc/profile
      # Temporary workaround for delay on DHCP response
      - sleep 4
      - wget https://raw.githubusercontent.com/Sabayon/sabayon-sark/develop/sark-functions.sh -O /sbin/sark-functions.sh
      - chmod 755 /sbin/sark-functions.sh
      - cp -rfv /sbin/sark-functions.sh /etc/sark-functions
      - chmod 755 /etc/sark-functions
      - echo '===> Preparing last step....'
      - wget https://raw.githubusercontent.com/Sabayon/devkit/develop/builder -O /usr/sbin/builder
      - wget https://raw.githubusercontent.com/Sabayon/sabayon-sark/develop/sark-localbuild -O /usr/bin/sark-localbuild
      - wget https://raw.githubusercontent.com/Sabayon/sabayon-sark/develop/sark-localcreaterepo -O /usr/bin/sark-localcreaterepo
      - chmod a+x /usr/sbin/builder
      - chmod a+x /usr/bin/sark-localcreaterepo
      - chmod a+x /usr/bin/sark-localbuild
      - eselect python set python3.6
      # Force py3.6 on eit
      - sed -e 's:python2.7:python:g' -i /usr/bin/eit
      # Create mask file of upstream packages
      - source /sbin/sark-functions.sh
      # Required for update profile confs
      - layman -s sabayon-distro
      - sabayon_mask_upstream_pkgs
      - equo up && equo upgrade
      # Temporary force build
      # - sed -e 's/--update//g' -e 's/--newuse//g' base-build-staging2.yml -i
      - sark-localbuild
      - eval 'rm artifacts/build_*.log || true'
      - mkdir artifacts/staging2
      - mv artifacts/base-arm-binhost/ artifacts/staging2/
    environment:
      - SHELL=/bin/bash
      - SABAYON_ARCH=arm
      - REPOSITORY_NAME=base-arm
      - SAB_BUILDFILE=base-build-staging2.yml
      - ETP_NONINTERACTIVE=1
      # I need call emerge-webrsync at begin to retrive data for active profile.
      # Note: When SKIP_PORTAGE_SYNC is equal to 1 "layman -S" is not executed.
      # - SKIP_PORTAGE_SYNC=1
      - SKIP_CLEAN_PACKAGESDIR=1
      - SAB_PORTDIR=/etc/portage
      - "CREATEREPO_PHASE=false"
      - "ACCEPT_LICENSE=*"
      - "PORTAGE_GIT_URL=https://github.com/Sabayon/gentoo-mirror"
      - "PORTAGE_GIT_BRANCH=arm"
      # Override list of targets for compile specific packages.
      # - OVERRIDE_BUILD_TARGET="app/foo"
    name: "ARM Base (Staging2)"
    artefact_path: artifacts
    
    image: sabayon/builder-arm
    type: lxd
    
    source: https://github.com/Sabayon/sbi-tasks
    directory: "/next/arm/base"
    queue: arm_lxd
    tag_namespace: base-arm-staging2

  staging3:
    script:
      - source /etc/profile
      # Temporary workaround for delay on DHCP response
      - sleep 4
      - wget https://raw.githubusercontent.com/Sabayon/sabayon-sark/develop/sark-functions.sh -O /sbin/sark-functions.sh
      - chmod 755 /sbin/sark-functions.sh
      - cp -rfv /sbin/sark-functions.sh /etc/sark-functions
      - chmod 755 /etc/sark-functions
      - echo '===> Preparing last step....'
      - wget https://raw.githubusercontent.com/Sabayon/devkit/develop/builder -O /usr/sbin/builder
      - wget https://raw.githubusercontent.com/Sabayon/sabayon-sark/develop/sark-localbuild -O /usr/bin/sark-localbuild
      - wget https://raw.githubusercontent.com/Sabayon/sabayon-sark/develop/sark-localcreaterepo -O /usr/bin/sark-localcreaterepo
      - chmod a+x /usr/sbin/builder
      - chmod a+x /usr/bin/sark-localcreaterepo
      - chmod a+x /usr/bin/sark-localbuild
      - eselect python set python3.6
      # Force py3.6 on eit
      - sed -e 's:python2.7:python:g' -i /usr/bin/eit
      # Create mask file of upstream packages
      - source /sbin/sark-functions.sh
      # Required for update profile confs
      - layman -s sabayon-distro
      - sabayon_mask_upstream_pkgs
      - equo up && equo upgrade
      # Temporary force build
      # - sed -e 's/--update//g' -e 's/--newuse//g' base-build-staging3.yml -i
      - sark-localbuild
      - eval 'rm artifacts/build_*.log || true'
      - mkdir artifacts/staging3
      - mv artifacts/base-arm-binhost/ artifacts/staging3/
    environment:
      - SHELL=/bin/bash
      - SABAYON_ARCH=arm
      - REPOSITORY_NAME=base-arm
      - SAB_BUILDFILE=base-build-staging3.yml
      - ETP_NONINTERACTIVE=1
      # I need call emerge-webrsync at begin to retrive data for active profile.
      # Note: When SKIP_PORTAGE_SYNC is equal to 1 "layman -S" is not executed.
      # - SKIP_PORTAGE_SYNC=1
      - SKIP_CLEAN_PACKAGESDIR=1
      - SAB_PORTDIR=/etc/portage
      - "CREATEREPO_PHASE=false"
      - "ACCEPT_LICENSE=*"
      - "PORTAGE_GIT_URL=https://github.com/Sabayon/gentoo-mirror"
      - "PORTAGE_GIT_BRANCH=arm"
      # Override list of targets for compile specific packages.
      # - OVERRIDE_BUILD_TARGET="app/foo"
    name: "ARM Base (Staging3)"
    artefact_path: artifacts
    
    image: sabayon/builder-arm
    type: lxd
    
    source: https://github.com/Sabayon/sbi-tasks
    directory: "/next/arm/base"
    queue: arm_lxd
    tag_namespace: base-arm-staging3

  staging4:
    script:
      - source /etc/profile
      # Temporary workaround for delay on DHCP response
      - sleep 4
      - wget https://raw.githubusercontent.com/Sabayon/sabayon-sark/develop/sark-functions.sh -O /sbin/sark-functions.sh
      - chmod 755 /sbin/sark-functions.sh
      - cp -rfv /sbin/sark-functions.sh /etc/sark-functions
      - chmod 755 /etc/sark-functions
      - echo '===> Preparing last step....'
      - wget https://raw.githubusercontent.com/Sabayon/devkit/develop/builder -O /usr/sbin/builder
      - wget https://raw.githubusercontent.com/Sabayon/sabayon-sark/develop/sark-localbuild -O /usr/bin/sark-localbuild
      - wget https://raw.githubusercontent.com/Sabayon/sabayon-sark/develop/sark-localcreaterepo -O /usr/bin/sark-localcreaterepo
      - chmod a+x /usr/sbin/builder
      - chmod a+x /usr/bin/sark-localcreaterepo
      - chmod a+x /usr/bin/sark-localbuild
      - eselect python set python3.6
      # Force py3.6 on eit
      - sed -e 's:python2.7:python:g' -i /usr/bin/eit
      # Create mask file of upstream packages
      - source /sbin/sark-functions.sh
      # Required for update profile confs
      - layman -s sabayon-distro
      - sabayon_mask_upstream_pkgs
      - equo up && equo upgrade
      # Temporary force build
      # - sed -e 's/--update//g' -e 's/--newuse//g' base-build-staging4.yml -i
      - sark-localbuild
      - eval 'rm artifacts/build_*.log || true'
      - mkdir artifacts/staging4
      - mv artifacts/base-arm-binhost/ artifacts/staging4/
    environment:
      - SHELL=/bin/bash
      - SABAYON_ARCH=arm
      - REPOSITORY_NAME=base-arm
      - SAB_BUILDFILE=base-build-staging4.yml
      - ETP_NONINTERACTIVE=1
      # I need call emerge-webrsync at begin to retrive data for active profile.
      # Note: When SKIP_PORTAGE_SYNC is equal to 1 "layman -S" is not executed.
      # - SKIP_PORTAGE_SYNC=1
      - SKIP_CLEAN_PACKAGESDIR=1
      - SAB_PORTDIR=/etc/portage
      - "CREATEREPO_PHASE=false"
      - "ACCEPT_LICENSE=*"
      - "PORTAGE_GIT_URL=https://github.com/Sabayon/gentoo-mirror"
      - "PORTAGE_GIT_BRANCH=arm"
      # Override list of targets for compile specific packages.
      # - OVERRIDE_BUILD_TARGET="app/foo"
    name: "ARM Base (Staging4)"
    artefact_path: artifacts
    
    image: sabayon/builder-arm
    type: lxd
    
    source: https://github.com/Sabayon/sbi-tasks
    directory: "/next/arm/base"
    queue: arm_lxd
    tag_namespace: base-arm-staging4

  staging5:
    script:
      - source /etc/profile
      # Temporary workaround for delay on DHCP response
      - sleep 4
      - wget https://raw.githubusercontent.com/Sabayon/sabayon-sark/develop/sark-functions.sh -O /sbin/sark-functions.sh
      - chmod 755 /sbin/sark-functions.sh
      - cp -rfv /sbin/sark-functions.sh /etc/sark-functions
      - chmod 755 /etc/sark-functions
      - echo '===> Preparing last step....'
      - wget https://raw.githubusercontent.com/Sabayon/devkit/develop/builder -O /usr/sbin/builder
      - wget https://raw.githubusercontent.com/Sabayon/sabayon-sark/develop/sark-localbuild -O /usr/bin/sark-localbuild
      - wget https://raw.githubusercontent.com/Sabayon/sabayon-sark/develop/sark-localcreaterepo -O /usr/bin/sark-localcreaterepo
      - chmod a+x /usr/sbin/builder
      - chmod a+x /usr/bin/sark-localcreaterepo
      - chmod a+x /usr/bin/sark-localbuild
      - eselect python set python3.6
      # Force py3.6 on eit
      - sed -e 's:python2.7:python:g' -i /usr/bin/eit
      # Create mask file of upstream packages
      - source /sbin/sark-functions.sh
      # Required for update profile confs
      - layman -s sabayon-distro
      - sabayon_mask_upstream_pkgs
      - equo up && equo upgrade
      # Temporary force build
      # - sed -e 's/--update//g' -e 's/--newuse//g' base-build-staging5.yml -i
      - sark-localbuild
      - eval 'rm artifacts/build_*.log || true'
      - mkdir artifacts/staging5
      - mv artifacts/base-arm-binhost/ artifacts/staging5/
    environment:
      - SHELL=/bin/bash
      - SABAYON_ARCH=arm
      - REPOSITORY_NAME=base-arm
      - SAB_BUILDFILE=base-build-staging5.yml
      - ETP_NONINTERACTIVE=1
      # I need call emerge-webrsync at begin to retrive data for active profile.
      # Note: When SKIP_PORTAGE_SYNC is equal to 1 "layman -S" is not executed.
      # - SKIP_PORTAGE_SYNC=1
      - SKIP_CLEAN_PACKAGESDIR=1
      - SAB_PORTDIR=/etc/portage
      - "CREATEREPO_PHASE=false"
      - "ACCEPT_LICENSE=*"
      - "PORTAGE_GIT_URL=https://github.com/Sabayon/gentoo-mirror"
      - "PORTAGE_GIT_BRANCH=arm"
      # Override list of targets for compile specific packages.
      # - OVERRIDE_BUILD_TARGET="app/foo"
    name: "ARM Base (Staging5)"
    artefact_path: artifacts
    
    image: sabayon/builder-arm
    type: lxd
    
    source: https://github.com/Sabayon/sbi-tasks
    directory: "/next/arm/base"
    queue: arm_lxd
    tag_namespace: base-arm-staging5

  staging6:
    script:
      - source /etc/profile
      # Temporary workaround for delay on DHCP response
      - sleep 4
      - wget https://raw.githubusercontent.com/Sabayon/sabayon-sark/develop/sark-functions.sh -O /sbin/sark-functions.sh
      - chmod 755 /sbin/sark-functions.sh
      - cp -rfv /sbin/sark-functions.sh /etc/sark-functions
      - chmod 755 /etc/sark-functions
      - echo '===> Preparing last step....'
      - wget https://raw.githubusercontent.com/Sabayon/devkit/develop/builder -O /usr/sbin/builder
      - wget https://raw.githubusercontent.com/Sabayon/sabayon-sark/develop/sark-localbuild -O /usr/bin/sark-localbuild
      - wget https://raw.githubusercontent.com/Sabayon/sabayon-sark/develop/sark-localcreaterepo -O /usr/bin/sark-localcreaterepo
      - chmod a+x /usr/sbin/builder
      - chmod a+x /usr/bin/sark-localcreaterepo
      - chmod a+x /usr/bin/sark-localbuild
      - eselect python set python3.6
      # Force py3.6 on eit
      - sed -e 's:python2.7:python:g' -i /usr/bin/eit
      # Create mask file of upstream packages
      - source /sbin/sark-functions.sh
      # Required for update profile confs
      - layman -s sabayon-distro
      - sabayon_mask_upstream_pkgs
      - equo up && equo upgrade
      # Temporary force build
      # - sed -e 's/--update//g' -e 's/--newuse//g' base-build-staging6.yml -i
      - sark-localbuild
      - eval 'rm artifacts/build_*.log || true'
      - mkdir artifacts/staging6
      - mv artifacts/base-arm-binhost/ artifacts/staging6/
    environment:
      - SHELL=/bin/bash
      - SABAYON_ARCH=arm
      - REPOSITORY_NAME=base-arm
      - SAB_BUILDFILE=base-build-staging6.yml
      - ETP_NONINTERACTIVE=1
      # I need call emerge-webrsync at begin to retrive data for active profile.
      # Note: When SKIP_PORTAGE_SYNC is equal to 1 "layman -S" is not executed.
      # - SKIP_PORTAGE_SYNC=1
      - SKIP_CLEAN_PACKAGESDIR=1
      - SAB_PORTDIR=/etc/portage
      - "CREATEREPO_PHASE=false"
      - "ACCEPT_LICENSE=*"
      - "PORTAGE_GIT_URL=https://github.com/Sabayon/gentoo-mirror"
      - "PORTAGE_GIT_BRANCH=arm"
      # Override list of targets for compile specific packages.
      # - OVERRIDE_BUILD_TARGET="app/foo"
    name: "ARM Base (Staging6)"
    artefact_path: artifacts
    
    image: sabayon/builder-arm
    type: lxd
    
    source: https://github.com/Sabayon/sbi-tasks
    directory: "/next/arm/base"
    queue: arm_lxd
    tag_namespace: base-arm-staging6

  staging7:
    script:
      - source /etc/profile
      # Temporary workaround for delay on DHCP response
      - sleep 4
      - wget https://raw.githubusercontent.com/Sabayon/sabayon-sark/develop/sark-functions.sh -O /sbin/sark-functions.sh
      - chmod 755 /sbin/sark-functions.sh
      - cp -rfv /sbin/sark-functions.sh /etc/sark-functions
      - chmod 755 /etc/sark-functions
      - echo '===> Preparing last step....'
      - wget https://raw.githubusercontent.com/Sabayon/devkit/develop/builder -O /usr/sbin/builder
      - wget https://raw.githubusercontent.com/Sabayon/sabayon-sark/develop/sark-localbuild -O /usr/bin/sark-localbuild
      - wget https://raw.githubusercontent.com/Sabayon/sabayon-sark/develop/sark-localcreaterepo -O /usr/bin/sark-localcreaterepo
      - chmod a+x /usr/sbin/builder
      - chmod a+x /usr/bin/sark-localcreaterepo
      - chmod a+x /usr/bin/sark-localbuild
      - eselect python set python3.6
      # Force py3.6 on eit
      - sed -e 's:python2.7:python:g' -i /usr/bin/eit
      # Create mask file of upstream packages
      - source /sbin/sark-functions.sh
      # Required for update profile confs
      - layman -s sabayon-distro
      - sabayon_mask_upstream_pkgs
      - equo up && equo upgrade
      # Temporary force build
      # - sed -e 's/--update//g' -e 's/--newuse//g' base-build-staging7.yml -i
      - sark-localbuild
      - eval 'rm artifacts/build_*.log || true'
      - mkdir artifacts/staging7
      - mv artifacts/base-arm-binhost/ artifacts/staging7/
    environment:
      - SHELL=/bin/bash
      - SABAYON_ARCH=arm
      - REPOSITORY_NAME=base-arm
      - SAB_BUILDFILE=base-build-staging7.yml
      - ETP_NONINTERACTIVE=1
      # I need call emerge-webrsync at begin to retrive data for active profile.
      # Note: When SKIP_PORTAGE_SYNC is equal to 1 "layman -S" is not executed.
      # - SKIP_PORTAGE_SYNC=1
      - SKIP_CLEAN_PACKAGESDIR=1
      - SAB_PORTDIR=/etc/portage
      - "CREATEREPO_PHASE=false"
      - "ACCEPT_LICENSE=*"
      - "PORTAGE_GIT_URL=https://github.com/Sabayon/gentoo-mirror"
      - "PORTAGE_GIT_BRANCH=arm"
      # Override list of targets for compile specific packages.
      # - OVERRIDE_BUILD_TARGET="app/foo"
    name: "ARM Base (Staging7)"
    artefact_path: artifacts
    
    image: sabayon/builder-arm
    type: lxd
    
    source: https://github.com/Sabayon/sbi-tasks
    directory: "/next/arm/base"
    queue: arm_lxd
    tag_namespace: base-arm-staging7

  staging8:
    script:
      - source /etc/profile
      # Temporary workaround for delay on DHCP response
      - sleep 4
      - wget https://raw.githubusercontent.com/Sabayon/sabayon-sark/develop/sark-functions.sh -O /sbin/sark-functions.sh
      - chmod 755 /sbin/sark-functions.sh
      - cp -rfv /sbin/sark-functions.sh /etc/sark-functions
      - chmod 755 /etc/sark-functions
      - echo '===> Preparing last step....'
      - wget https://raw.githubusercontent.com/Sabayon/devkit/develop/builder -O /usr/sbin/builder
      - wget https://raw.githubusercontent.com/Sabayon/sabayon-sark/develop/sark-localbuild -O /usr/bin/sark-localbuild
      - wget https://raw.githubusercontent.com/Sabayon/sabayon-sark/develop/sark-localcreaterepo -O /usr/bin/sark-localcreaterepo
      - chmod a+x /usr/sbin/builder
      - chmod a+x /usr/bin/sark-localcreaterepo
      - chmod a+x /usr/bin/sark-localbuild
      - eselect python set python3.6
      # Force py3.6 on eit
      - sed -e 's:python2.7:python:g' -i /usr/bin/eit
      # Create mask file of upstream packages
      - source /sbin/sark-functions.sh
      # Required for update profile confs
      - layman -s sabayon-distro
      - sabayon_mask_upstream_pkgs
      - equo up && equo upgrade
      # Temporary force build
      # - sed -e 's/--update//g' -e 's/--newuse//g' base-build-staging8.yml -i
      - sark-localbuild
      - eval 'rm artifacts/build_*.log || true'
      - mkdir artifacts/staging8
      - mv artifacts/base-arm-binhost/ artifacts/staging8/
    environment:
      - SHELL=/bin/bash
      - SABAYON_ARCH=arm
      - REPOSITORY_NAME=base-arm
      - SAB_BUILDFILE=base-build-staging8.yml
      - ETP_NONINTERACTIVE=1
      # I need call emerge-webrsync at begin to retrive data for active profile.
      # Note: When SKIP_PORTAGE_SYNC is equal to 1 "layman -S" is not executed.
      # - SKIP_PORTAGE_SYNC=1
      - SKIP_CLEAN_PACKAGESDIR=1
      - SAB_PORTDIR=/etc/portage
      - "CREATEREPO_PHASE=false"
      - "ACCEPT_LICENSE=*"
      - "PORTAGE_GIT_URL=https://github.com/Sabayon/gentoo-mirror"
      - "PORTAGE_GIT_BRANCH=arm"
      # Override list of targets for compile specific packages.
      # - OVERRIDE_BUILD_TARGET="app/foo"
    name: "ARM Base (Staging8)"
    artefact_path: artifacts
    
    image: sabayon/builder-arm
    type: lxd
    
    source: https://github.com/Sabayon/sbi-tasks
    directory: "/next/arm/base"
    queue: arm_lxd
    tag_namespace: base-arm-staging8

  staging9:
    script:
      - source /etc/profile
      # Temporary workaround for delay on DHCP response
      - sleep 4
      - wget https://raw.githubusercontent.com/Sabayon/sabayon-sark/develop/sark-functions.sh -O /sbin/sark-functions.sh
      - chmod 755 /sbin/sark-functions.sh
      - cp -rfv /sbin/sark-functions.sh /etc/sark-functions
      - chmod 755 /etc/sark-functions
      - echo '===> Preparing last step....'
      - wget https://raw.githubusercontent.com/Sabayon/devkit/develop/builder -O /usr/sbin/builder
      - wget https://raw.githubusercontent.com/Sabayon/sabayon-sark/develop/sark-localbuild -O /usr/bin/sark-localbuild
      - wget https://raw.githubusercontent.com/Sabayon/sabayon-sark/develop/sark-localcreaterepo -O /usr/bin/sark-localcreaterepo
      - chmod a+x /usr/sbin/builder
      - chmod a+x /usr/bin/sark-localcreaterepo
      - chmod a+x /usr/bin/sark-localbuild
      - eselect python set python3.6
      # Force py3.6 on eit
      - sed -e 's:python2.7:python:g' -i /usr/bin/eit
      # Create mask file of upstream packages
      - source /sbin/sark-functions.sh
      # Required for update profile confs
      - layman -s sabayon-distro
      - sabayon_mask_upstream_pkgs
      - equo up && equo upgrade
      # Temporary force build
      # - sed -e 's/--update//g' -e 's/--newuse//g' base-build-staging9.yml -i
      - sark-localbuild
      - eval 'rm artifacts/build_*.log || true'
      - mkdir artifacts/staging9
      - mv artifacts/base-arm-binhost/ artifacts/staging9/
    environment:
      - SHELL=/bin/bash
      - SABAYON_ARCH=arm
      - REPOSITORY_NAME=base-arm
      - SAB_BUILDFILE=base-build-staging9.yml
      - ETP_NONINTERACTIVE=1
      # I need call emerge-webrsync at begin to retrive data for active profile.
      # Note: When SKIP_PORTAGE_SYNC is equal to 1 "layman -S" is not executed.
      # - SKIP_PORTAGE_SYNC=1
      - SKIP_CLEAN_PACKAGESDIR=1
      - SAB_PORTDIR=/etc/portage
      - "CREATEREPO_PHASE=false"
      - "ACCEPT_LICENSE=*"
      - "PORTAGE_GIT_URL=https://github.com/Sabayon/gentoo-mirror"
      - "PORTAGE_GIT_BRANCH=arm"
      # Override list of targets for compile specific packages.
      # - OVERRIDE_BUILD_TARGET="app/foo"
    name: "ARM Base (Staging9)"
    artefact_path: artifacts
    
    image: sabayon/builder-arm
    type: lxd
    
    source: https://github.com/Sabayon/sbi-tasks
    directory: "/next/arm/base"
    queue: arm_lxd
    tag_namespace: base-arm-staging9


  injector:







    script:
      - source /etc/profile
      - wget https://raw.githubusercontent.com/Sabayon/sabayon-sark/develop/sark-functions.sh -O /sbin/sark-functions.sh
      - chmod 755 /sbin/sark-functions.sh
      - cp -rfv /sbin/sark-functions.sh /etc/sark-functions
      - chmod 755 /etc/sark-functions
      - wget https://raw.githubusercontent.com/Sabayon/devkit/develop/builder -O /usr/sbin/builder
      - wget https://raw.githubusercontent.com/Sabayon/sabayon-sark/develop/sark-localbuild -O /usr/bin/sark-localbuild
      - wget https://raw.githubusercontent.com/Sabayon/sabayon-sark/develop/sark-localcreaterepo -O /usr/bin/sark-localcreaterepo
      - wget https://raw.githubusercontent.com/Sabayon/sabayon-sark/develop/sark-localinjector -O /usr/bin/sark-localinjector
      - chmod a+x /usr/sbin/builder
      - chmod a+x /usr/bin/sark-localcreaterepo
      - chmod a+x /usr/bin/sark-localbuild
      - chmod a+x /usr/bin/sark-localinjector
      - eselect python set python3.6
      # Force py3.6 on eit
      - sed -e 's:python2.7:python:g' -i /usr/bin/eit
      # Create mask file of upstream packages
      - source /sbin/sark-functions.sh
      # Required for update profile confs
      - layman -s sabayon-distro
      - sabayon_mask_upstream_pkgs
      - enman add https://dispatcher.sabayon.org/sbi/namespace/base-arm/base-arm
      - equo up && equo upgrade
      - sark-localinjector
      - eval 'rm artifacts/build_*.log || true'
    environment:
      - SHELL=/bin/bash
      - SABAYON_ARCH=arm
      - ETP_NONINTERACTIVE=1
      - REPOSITORY_NAME=base-arm
      - REPO_CLEAN_EXPIRE=1
      - REPO_CLEAN_EXPIRE_DAYS=5
      - SKIP_COMMIT=1
      # Pull is required for remove packages from repository. (SKIP_PULL=0)
      - SKIP_PULL=0
      - "SAB_STAGING_BUILD_RESOURCES=base-build-staging1.yml base-build-staging10.yml base-build-staging11.yml base-build-staging12.yml base-build-staging13.yml base-build-staging14.yml base-build-staging15.yml base-build-staging16.yml base-build-staging17.yml base-build-staging2.yml base-build-staging3.yml base-build-staging4.yml base-build-staging5.yml base-build-staging6.yml base-build-staging7.yml base-build-staging8.yml base-build-staging9.yml"
    
      - SKIP_INJECT=0
    
      - SAB_PORTDIR=/etc/portage
      - "ACCEPT_LICENSE=*"
      - "PORTAGE_GIT_URL=https://github.com/Sabayon/gentoo-mirror"
      - "PORTAGE_GIT_BRANCH=arm"
      - "REPOSITORY_DESCRIPTION=Base ARM Sabayon Repository"
      - "SAB_STAGING_DIRS=staging1 staging10 staging11 staging12 staging13 staging14 staging15 staging16 staging17 staging2 staging3 staging4 staging5 staging6 staging7 staging8 staging9"
      - REPO_BINHOST_CLEAN=1
      - SAB_BUILDFILE=base-build-inject.yml
      # Skip errors on process existing broken tarballs
      #- "PKGS_CHECKER_OPTS=-L ERROR -c -v --ignore-errors"
      # Disable temporary concurrency for pthread_create failed: Resource temporarily unavailable
      - "PKGS_CHECKER_OPTS=-L ERROR -v --ignore-errors"
      - "PKGS_CHECKER_MAXCONCURRENCY=3"
      # Override pkgs-checker filter options
      # - "PKGS_CHECKER_FILTER_OPTS=-L INFO -v"
    
    
      - "EIT_REMOVE_OPTS=--quick --nodeps"
    
      # Force remove of packages from repository after injection
      # - "TOREMOVE=app/foo"
    
    image: geaaru/sabayon-builder-arm
    type: docker
    
    artefact_path: artifacts
    queue: arm_injector
    name: "ARM Base Repo (injector)"
    source: https://github.com/Sabayon/sbi-tasks
    directory: "/next/arm/base"
    namespace: "base-arm,base-arm-staging1,base-arm-staging10,base-arm-staging11,base-arm-staging12,base-arm-staging13,base-arm-staging14,base-arm-staging15,base-arm-staging16,base-arm-staging17,base-arm-staging2,base-arm-staging3,base-arm-staging4,base-arm-staging5,base-arm-staging6,base-arm-staging7,base-arm-staging8,base-arm-staging9"
    tag_namespace: base-arm
