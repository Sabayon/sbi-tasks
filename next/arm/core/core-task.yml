
script:
  - export LC_ALL=en_US.UTF-8
  - eval "export SOURCE_DIR=$(pwd)"
  - echo "SOURCE_DIR = ${SOURCE_DIR}"
  - ./scripts/build-core.sh init
  - ./scripts/build-core.sh build
  - wget https://dispatcher.sabayon.org/sbi/namespace/core-staging-arm/pkgs-checker_linux_arm -O /usr/bin/pkgs-checker
  - chmod a+x /usr/bin/pkgs-checker
  - wget https://raw.githubusercontent.com/Sabayon/sabayon-sark/develop/sark-functions.sh -O /sbin/sark-functions.sh
  - chmod 755 /sbin/sark-functions.sh
  - cp -rfv /sbin/sark-functions.sh /etc/sark-functions
  - chmod 755 /etc/sark-functions
  - echo '===> Preparing last step....'
  - wget https://raw.githubusercontent.com/Sabayon/devkit/master/builder -O /usr/sbin/builder
  - wget https://raw.githubusercontent.com/Sabayon/sabayon-sark/develop/sark-localbuild -O ./sark-localbuild
  - chmod a+x /usr/sbin/builder
  - chmod a+x ./sark-localbuild
  - SAB_BUILDFILE=core-build.yml ./sark-localbuild
environment:
  - SHELL=/bin/bash
  - SABAYON_ARCH=arm
  - USE_EQUO=0
  - REPOSITORY_NAME=core-arm
    # Avoid sync of portage 
  - SKIP_PORTAGE_SYNC=1
    # Avoid remove of portagate with compiled packages.
  - SKIP_CLEAN_PACKAGESDIR=1
  - BUILDER_PROFILE=65
  - SKIP_COMMIT=1
  - SKIP_PULL=1
task: docker_execute
artefact_path: artifacts
image: geaaru/stage3-gentoo-systemd-armv7a_hardfp
source: https://github.com/Sabayon/sbi-tasks
directory: "/next/arm/core"
queue: arm

